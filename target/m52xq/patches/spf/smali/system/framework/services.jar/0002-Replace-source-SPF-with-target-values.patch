From e52748a595a9670b2beee60952d46d04fb3a0035 Mon Sep 17 00:00:00 2001
From: BlackMesa123 <giangrecosalvo9@gmail.com>
Date: Fri, 15 Dec 2023 13:47:32 +0100
Subject: [PATCH] Replace source SPF with target values

---
 ...eplace-source-SPF-with-target-values.patch | 100 ++++++++++++++++++
 .../android/server/audio/AudioService.smali   |   2 +-
 .../fingerprint/FingerprintUtils.smali        |   2 +-
 .../display/SemMdnieManagerService.smali      |   2 +-
 .../enterprise/hdm/HdmVendorController.smali  |   2 +-
 .../server/power/PowerManagerUtil.smali       |   2 +-
 6 files changed, 105 insertions(+), 5 deletions(-)
 create mode 100644 0002-Replace-source-SPF-with-target-values.patch

diff --git a/0002-Replace-source-SPF-with-target-values.patch b/0002-Replace-source-SPF-with-target-values.patch
new file mode 100644
index 00000000..3690544f
--- /dev/null
+++ b/0002-Replace-source-SPF-with-target-values.patch
@@ -0,0 +1,100 @@
+From 8c53f20af71b821eb546a8eb95502722d2d5c638 Mon Sep 17 00:00:00 2001
+From: BlackMesa123 <giangrecosalvo9@gmail.com>
+Date: Wed, 6 Dec 2023 12:14:06 +0100
+Subject: [PATCH] Replace source SPF with target values
+
+---
+ smali/com/android/server/SystemServer.smali                   | 4 ++--
+ smali/com/android/server/audio/AudioService.smali             | 2 +-
+ .../biometrics/sensors/fingerprint/FingerprintUtils.smali     | 2 +-
+ .../android/hardware/display/SemMdnieManagerService.smali     | 2 +-
+ .../android/server/enterprise/hdm/HdmVendorController.smali   | 2 +-
+ .../com/android/server/power/PowerManagerUtil.smali           | 2 +-
+ 6 files changed, 7 insertions(+), 7 deletions(-)
+
+diff --git a/smali/com/android/server/SystemServer.smali b/smali/com/android/server/SystemServer.smali
+index 21a1955b..a2e45f11 100644
+--- a/smali/com/android/server/SystemServer.smali
++++ b/smali/com/android/server/SystemServer.smali
+@@ -4780,11 +4780,11 @@
+ 
+     const-string v10, "SystemServer"
+ 
+-    const-string v11, "MAINLINE_API_LEVEL: 33"
++    const-string v11, "MAINLINE_API_LEVEL: 30"
+ 
+     invoke-static {v10, v11}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I
+ 
+-    const-string v10, "33"
++    const-string v10, "30"
+ 
+     invoke-static {v10}, Ljava/lang/Integer;->parseInt(Ljava/lang/String;)I
+ 
+diff --git a/smali/com/android/server/audio/AudioService.smali b/smali/com/android/server/audio/AudioService.smali
+index 3969eea3..ccd35389 100644
+--- a/smali/com/android/server/audio/AudioService.smali
++++ b/smali/com/android/server/audio/AudioService.smali
+@@ -4562,7 +4562,7 @@
+ 
+     invoke-virtual {p1, v0}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V
+ 
+-    const/4 v0, 0x1
++    const/4 v0, 0x0
+ 
+     invoke-virtual {p1, v0}, Ljava/io/PrintWriter;->println(Z)V
+ 
+diff --git a/smali/com/android/server/biometrics/sensors/fingerprint/FingerprintUtils.smali b/smali/com/android/server/biometrics/sensors/fingerprint/FingerprintUtils.smali
+index 484cd1a5..1803de9c 100644
+--- a/smali/com/android/server/biometrics/sensors/fingerprint/FingerprintUtils.smali
++++ b/smali/com/android/server/biometrics/sensors/fingerprint/FingerprintUtils.smali
+@@ -442,7 +442,7 @@
+ .method public static semGetMaxTemplateNumberFromSPF()I
+     .locals 6
+ 
+-    const-string v0, "google_touch_display_ultrasonic"
++    const-string v0, "google_touch_side,settings=3,navi=1"
+ 
+     const-string v1, ","
+ 
+diff --git a/smali/com/samsung/android/hardware/display/SemMdnieManagerService.smali b/smali/com/samsung/android/hardware/display/SemMdnieManagerService.smali
+index ed39a90f..1a1661df 100644
+--- a/smali/com/samsung/android/hardware/display/SemMdnieManagerService.smali
++++ b/smali/com/samsung/android/hardware/display/SemMdnieManagerService.smali
+@@ -703,7 +703,7 @@
+ 
+     iput-object v12, v0, Lcom/samsung/android/hardware/display/SemMdnieManagerService;->mLock:Ljava/lang/Object;
+ 
+-    const-string v12, "65303"
++    const-string v12, "65301"
+ 
+     invoke-static {v12}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;
+ 
+diff --git a/smali_classes2/com/android/server/enterprise/hdm/HdmVendorController.smali b/smali_classes2/com/android/server/enterprise/hdm/HdmVendorController.smali
+index 8f57af8e..2b5d17ad 100644
+--- a/smali_classes2/com/android/server/enterprise/hdm/HdmVendorController.smali
++++ b/smali_classes2/com/android/server/enterprise/hdm/HdmVendorController.smali
+@@ -13,7 +13,7 @@
+ 
+     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
+ 
+-    const-string v0, "33"
++    const-string v0, "30"
+ 
+     invoke-static {v0}, Ljava/lang/Integer;->parseInt(Ljava/lang/String;)I
+ 
+diff --git a/smali_classes3/com/android/server/power/PowerManagerUtil.smali b/smali_classes3/com/android/server/power/PowerManagerUtil.smali
+index f1163443..502868b2 100644
+--- a/smali_classes3/com/android/server/power/PowerManagerUtil.smali
++++ b/smali_classes3/com/android/server/power/PowerManagerUtil.smali
+@@ -845,7 +845,7 @@
+ 
+     sput-boolean v11, Lcom/android/server/power/PowerManagerUtil;->SEC_FEATURE_HQM_SEND_LBHD_HIGHEST:Z
+ 
+-    const/4 v0, 0x1
++    const/4 v0, 0x0
+ 
+     sput-boolean v0, Lcom/android/server/power/PowerManagerUtil;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
+ 
+-- 
+2.43.0
+
diff --git a/smali/com/android/server/audio/AudioService.smali b/smali/com/android/server/audio/AudioService.smali
index 3969eea3..ccd35389 100644
--- a/smali/com/android/server/audio/AudioService.smali
+++ b/smali/com/android/server/audio/AudioService.smali
@@ -4562,7 +4562,7 @@
 
     invoke-virtual {p1, v0}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V
 
-    const/4 v0, 0x1
+    const/4 v0, 0x0
 
     invoke-virtual {p1, v0}, Ljava/io/PrintWriter;->println(Z)V
 
diff --git a/smali/com/android/server/biometrics/sensors/fingerprint/FingerprintUtils.smali b/smali/com/android/server/biometrics/sensors/fingerprint/FingerprintUtils.smali
index 484cd1a5..1803de9c 100644
--- a/smali/com/android/server/biometrics/sensors/fingerprint/FingerprintUtils.smali
+++ b/smali/com/android/server/biometrics/sensors/fingerprint/FingerprintUtils.smali
@@ -442,7 +442,7 @@
 .method public static semGetMaxTemplateNumberFromSPF()I
     .locals 6
 
-    const-string v0, "google_touch_display_ultrasonic"
+    const-string v0, "google_touch_side,settings=3,navi=1"
 
     const-string v1, ","
 
diff --git a/smali/com/samsung/android/hardware/display/SemMdnieManagerService.smali b/smali/com/samsung/android/hardware/display/SemMdnieManagerService.smali
index ed39a90f..1a1661df 100644
--- a/smali/com/samsung/android/hardware/display/SemMdnieManagerService.smali
+++ b/smali/com/samsung/android/hardware/display/SemMdnieManagerService.smali
@@ -703,7 +703,7 @@
 
     iput-object v12, v0, Lcom/samsung/android/hardware/display/SemMdnieManagerService;->mLock:Ljava/lang/Object;
 
-    const-string v12, "65303"
+    const-string v12, "65301"
 
     invoke-static {v12}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;
 
diff --git a/smali_classes2/com/android/server/enterprise/hdm/HdmVendorController.smali b/smali_classes2/com/android/server/enterprise/hdm/HdmVendorController.smali
index 8f57af8e..2b5d17ad 100644
--- a/smali_classes2/com/android/server/enterprise/hdm/HdmVendorController.smali
+++ b/smali_classes2/com/android/server/enterprise/hdm/HdmVendorController.smali
@@ -13,7 +13,7 @@
 
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
-    const-string v0, "33"
+    const-string v0, "30"
 
     invoke-static {v0}, Ljava/lang/Integer;->parseInt(Ljava/lang/String;)I
 
diff --git a/smali_classes3/com/android/server/power/PowerManagerUtil.smali b/smali_classes3/com/android/server/power/PowerManagerUtil.smali
index f1163443..502868b2 100644
--- a/smali_classes3/com/android/server/power/PowerManagerUtil.smali
+++ b/smali_classes3/com/android/server/power/PowerManagerUtil.smali
@@ -845,7 +845,7 @@
 
     sput-boolean v11, Lcom/android/server/power/PowerManagerUtil;->SEC_FEATURE_HQM_SEND_LBHD_HIGHEST:Z
 
-    const/4 v0, 0x1
+    const/4 v0, 0x0
 
     sput-boolean v0, Lcom/android/server/power/PowerManagerUtil;->SECURITY_FINGERPRINT_IN_DISPLAY:Z
 
-- 
2.43.0

